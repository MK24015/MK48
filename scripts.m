%% ??????? ?????????
close all;
clear all;
clc;
%% ????????? ??????? ???????? ???? ????? ?? ?????
dataAo = xlsread('A0ph_do_8_s_shagom_0_01_Material_5900_3100.xlsx');
dataSo = xlsread('S0ph_do_8_s_shagom_0_01_Material_5900_3100.xlsx');

phaseSpeedAo = dataAo(:,2); % ??????? ???????? ??? Ao
phaseSpeedSo = dataSo(:,2); % ??????? ???????? ??? So
frequency = dataAo(:,1); % ???????, ??????? ?? ?????? ?????
%% ????????? ??? ????????????? - df
% ??????: ?????? N ????? 8192, ???? ? ??????????? ?????? ? ????? ??
% ?????????? ?????? ? ??????????, ? ??????? ???? ??????? ?????????: ??
% ?????????? ??????, ??? ???????? h = 8?? ??? f = (30 ... 500) ??? ? ?????
% df ??????? ap(f,z). ?? ???? ?????????? ?? ???????, ?? ? ???????????
% ???????????? ??????? ???????? ? ?????? ??? 800 ?????????, ? ?? 8192.
% ??? ? ?? ??? ?????? ??? ???????? ?????? ????? ??????? ???????????????? ? 
% ????????? ????? ??????????????
N = 8192;
dL = 2*pi / N; 
fj = 2*10^6; % ??????? ?????????????
df = dL * fj / (2 * pi);
%% ????? S ??? ??????? Ao
X = zeros(length(phaseSpeedAo), 1);
X(length(phaseSpeedAo)/2) = 1;
Sf = fft(X); % ?????????????? ?????

% ??????: ? ?????????? ???? ??????? ??????????, ??????? ???????????? ???
% sigmaF ??? F', ? ??????? Sz(f) = F'[...], F' ??? ???????????
% ?.? ?????????? ????? ???????? ??? Szf (????) ? ?????????(30 ... 500) ????

% ??????: ??? ?????????? Ap, ??? ??????????? ???????? z? ??? ??? ????? ??
% ????????????.

% ??????: ??? ?? ??????? Sz(f)? ??? ?? ??????? S, ??? ?? ?????
Ap = frequency ./ phaseSpeedAo .* exp(2j*pi);
Szf = Sf .* Ap;
S = ifft(Szf);
%% ?????????? ????????
figure% ??????? ????? ????
subplot(3,1,1);% ????? ??????? ???? ??? ??????????
plot(frequency,phaseSpeedAo);% ?????????? ???????
title('Phase velocity for Ao signal');% ??????? ???????
xlabel('Frequency (MHz * mm)');% ??????? ??? ? ???????
ylabel('Phase velocity (s / dt)');% ??????? ??? ? ???????
subplot(3,1,2);% ????? ??????? ???? ??? ??????????
plot(frequency,Szf);% ?????????? ???????
title('');% ??????? ???????
xlabel('Frequency (MHz * mm)');% ??????? ??? ? ???????
ylabel('Phase velocity (s / dt)');% ??????? ??? ? ???????
subplot(3,1,3);% ????? ??????? ???? ??? ??????????
plot(frequency,S);% ?????????? ???????
title('');% ??????? ???????
xlabel('Frequency (MHz * mm)');% ??????? ??? ? ???????
ylabel('Phase velocity (s / dt)');% ??????? ??? ? ???????
%% ????? S ??? ??????? So
X = zeros(length(phaseSpeedSo), 1);
X(length(phaseSpeedSo)/2) = 1;
Sf = fft(X); % ?????????????? ?????

Ap = frequency ./ phaseSpeedSo .* exp(2j*pi);
Szf = Sf .* Ap;
S = ifft(Szf);
%% ?????????? ????????
figure% ??????? ????? ????
subplot(3,1,1);% ????? ??????? ???? ??? ??????????
plot(frequency,phaseSpeedSo);% ?????????? ???????
title('Phase velocity for So signal');% ??????? ???????
xlabel('Frequency (MHz * mm)');% ??????? ??? ? ???????
ylabel('Phase velocity (s / dt)');% ??????? ??? ? ???????
subplot(3,1,2);% ????? ??????? ???? ??? ??????????
plot(frequency,Szf);% ?????????? ???????
title('');% ??????? ???????
xlabel('Frequency (MHz * mm)');% ??????? ??? ? ???????
ylabel('Phase velocity (s / dt)');% ??????? ??? ? ???????
subplot(3,1,3);% ????? ??????? ???? ??? ??????????
plot(frequency,S);% ?????????? ???????
title('');% ??????? ???????
xlabel('Frequency (MHz * mm)');% ??????? ??? ? ???????
ylabel('Phase velocity (s / dt)');% ??????? ??? ? ???????